#!/bin/bash
sudo bash -c 'PRIMARY_DNS="$1"; SECONDARY_DNS="$2"; if [ -z "$PRIMARY_DNS" ] || [ -z "$SECONDARY_DNS" ]; then echo "Error: Please provide two DNS servers (e.g., sudo bash -c \"\$(curl -s URL)\" 8.8.8.8 8.8.4.4)"; exit 1; fi; if command -v nmcli >/dev/null 2>&1 && systemctl is-active NetworkManager >/dev/null 2>&1 && CONN=$(nmcli -t -f NAME,STATE con show --active | grep ":activated" | cut -d: -f1 | head -n1) && [ -n "$CONN" ]; then nmcli con mod "$CONN" ipv4.dns "$PRIMARY_DNS $SECONDARY_DNS" && nmcli con mod "$CONN" ipv4.ignore-auto-dns yes && nmcli con up "$CONN" && echo "DNS set via NetworkManager to $PRIMARY_DNS $SECONDARY_DNS" && nmcli con show "$CONN" | grep -q "$PRIMARY_DNS" && nslookup google.com "$PRIMARY_DNS" >/dev/null 2>&1 && echo "DNS change verified and tested" || echo "DNS change may have failed"; else cp /etc/resolv.conf /etc/resolv.conf.backup 2>/dev/null && echo "nameserver $PRIMARY_DNS" > /etc/resolv.conf && echo "nameserver $SECONDARY_DNS" >> /etc/resolv.conf && echo "DNS set via resolv.conf to $PRIMARY_DNS $SECONDARY_DNS" && grep "$PRIMARY_DNS" /etc/resolv.conf >/dev/null && nslookup google.com "$PRIMARY_DNS" >/dev/null 2>&1 && echo "DNS change verified and tested" || echo "DNS change may have failed"; fi'
